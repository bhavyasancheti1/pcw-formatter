openapi: 3.1.0
info:
  title: PCW Formatter API
  version: 1.0.0
  description: |
    Upload a GPT-generated Excel file and a PCW template to generate a filled PCW document.
    This endpoint fills out an Excel template based on GPT output and returns the completed file.

servers:
  - url: https://pcw-formatter-2.onrender.com

paths:
  /generate-pcw/:
    post:
      operationId: generatePcw
      summary: Generate a filled PCW Excel file from GPT output and template
      description: Accepts two Excel files via multipart/form-data and returns the filled-out PCW document.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                gpt_output:
                  type: string
                  format: binary
                  description: Excel file generated by GPT (with sheets like Parts List, Labor, etc.)
                pcw_template:
                  type: string
                  format: binary
                  description: Excel template to be filled using GPT output
              required:
                - gpt_output
                - pcw_template
      responses:
        '200':
          description: Successfully generated the PCW Excel file
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        '422':
          description: One or both files were missing or invalid
        '500':
          description: Internal server error during formatting
